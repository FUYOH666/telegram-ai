# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Telegram AI Platform

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç–∞—Ç—É—Å-–ø—Ä–æ–µ–∫—Ç–∞)
2. [–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–∫–∞—á–µ—Å—Ç–≤–æ-–∫–æ–¥–∞-–∏-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
3. [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏](#—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ-–º–∏–≥—Ä–∞—Ü–∏–∏)
4. [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Rate Limiting](#—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ-rate-limiting)
5. [–û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏](#–æ—Ç—á–µ—Ç-–æ-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏)

---

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-07  
**–í–µ—Ä—Å–∏—è:** 0.7.1

### ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç.

### üìä –°—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-----------|--------|------------|
| Telegram Bot Service | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `scripts/start_telegram_bot.py` |
| API Gateway | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 8 REST endpoints, –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `scripts/start_api_gateway.py` |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLite) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 15 —Ç–∞–±–ª–∏—Ü, 5 –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL) | ‚úÖ –ì–æ—Ç–æ–≤ | –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã, –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è |
| Redis | ‚ö†Ô∏è –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –±–∞–∑–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã |
| AI Client (vLLM) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü–æ–¥–∫–ª—é—á–µ–Ω –∫ AI —Å–µ—Ä–≤–µ—Ä—É (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `AI_SERVER_BASE_URL`) |
| Voice Handler (ASR) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü–æ–¥–∫–ª—é—á–µ–Ω –∫ ASR —Å–µ—Ä–≤–µ—Ä—É (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `ASR_SERVER_BASE_URL`) |
| URL Parser | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ –≤–µ–±-—Å—Å—ã–ª–æ–∫ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö (trafilatura + BeautifulSoup) |
| –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü—Ä–∏–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã |
| –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–≤—Ö–æ–¥—è—â–∏–µ) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è —á–µ—Ä–µ–∑ ASR —Å–µ—Ä–≤–µ—Ä |
| –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∏—Å—Ö–æ–¥—è—â–∏–µ) | ‚ö†Ô∏è –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | Telethon –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å |
| –¢–µ—Å—Ç—ã | ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç | Pytest —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —Ç–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã |
| Confidence-based Slot Extraction | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–ª–æ—Ç–æ–≤ —Å confidence scores |
| Fit-score —Å–∏—Å—Ç–µ–º–∞ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–∏–¥–æ–≤ |
| EventBus | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –°–æ–±—ã—Ç–∏–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –≥–∏–±–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
| –ü—Ä–µ–¥–±—Ä–æ–Ω—å –≤—Å—Ç—Ä–µ—á | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | Tentative events —Å –∞–≤—Ç–æ-–æ—Ç–º–µ–Ω–æ–π |
| PDPA —Å–æ–≥–ª–∞—Å–∏—è | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |

### üìã –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

#### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚úÖ –ü—Ä–∏–µ–º –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –ü—Ä–∏–µ–º –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å vLLM —Å–µ—Ä–≤–µ—Ä–æ–º –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤ –≤ –ë–î
- ‚úÖ RAG —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ knowledge base
- ‚úÖ Rate limiting –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞
- ‚úÖ **–ü–∞—Ä—Å–∏–Ω–≥ –≤–µ–±-—Å—Å—ã–ª–æ–∫** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å–ª–æ—Ç–æ–≤** (v0.7.0)
- ‚úÖ **Fit-score —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ª–∏–¥–æ–≤** (v0.7.0)
- ‚úÖ **–°–æ–±—ã—Ç–∏–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (EventBus)** (v0.7.0)
- ‚úÖ **–ü—Ä–µ–¥–±—Ä–æ–Ω—å –≤—Å—Ç—Ä–µ—á (tentative events)** (v0.7.0)
- ‚úÖ **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å—Ç—Ä–µ—á** (v0.7.0)
- ‚úÖ **PDPA —Å–æ–≥–ª–∞—Å–∏—è (Consent Management)** (v0.7.0)
- ‚úÖ **–ú–∏–Ω–∏-–ø–æ–≤–µ—Å—Ç–∫–∞ –≤—Å—Ç—Ä–µ—á** (v0.7.0)
- ‚úÖ REST API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π (8 endpoints)
- ‚úÖ Google Calendar –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–ª–æ—Ç–æ–≤ –∏–∑ –¥–∏–∞–ª–æ–≥–æ–≤
- ‚úÖ Sales flow —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- ‚úÖ **Prometheus –º–µ—Ç—Ä–∏–∫–∏** (v0.7.1) - `/metrics` endpoint –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ **Code quality tools** (v0.7.1) - Ruff, Pyright, Bandit, Codespell
- ‚úÖ **Pre-commit hooks** (v0.7.1) - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
- ‚úÖ **Security scan** (v0.7.1) - Trivy –¥–ª—è Docker –æ–±—Ä–∞–∑–æ–≤ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

#### ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚ö†Ô∏è Worker Service (Celery) - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞, –∑–∞–¥–∞—á–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å
- ‚ö†Ô∏è Analytics Service - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞, —ç–∫—Å–ø–æ—Ä—Ç –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
- ‚ö†Ô∏è LangChain/LangGraph - –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å

#### ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚ùå –û—Ç–ø—Ä–∞–≤–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –±–æ—Ç–∞ (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ TTS)
- ‚ùå –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ClickUp/Google Sheets (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞)

## –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞:

- **Ruff** - –ª–∏–Ω—Ç–∏–Ω–≥ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ (–∑–∞–º–µ–Ω—è–µ—Ç black + flake8)
- **Pyright** - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ (–±—ã—Å—Ç—Ä–µ–µ mypy)
- **Bandit** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞
- **Codespell** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏
- **pip-audit** - –∞—É–¥–∏—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö

### Pre-commit hooks

–ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º:

```bash
# –ê–∫—Ç–∏–≤–∞—Ü–∏—è pre-commit hooks
uv sync
uv run pre-commit install

# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
uv run pre-commit run --all-files
```

–•—É–∫–∏ –≤–∫–ª—é—á–∞—é—Ç:
- Ruff (lint + format)
- Pyright (type checking)
- Bandit (security)
- Codespell (spell checking)
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ pre-commit hooks (trailing whitespace, end-of-file, YAML/JSON/TOML validation)

### CI/CD

GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:

1. **Test job**:
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ `uv sync`
   - –õ–∏–Ω—Ç–∏–Ω–≥ —Å Ruff
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ —Å Pyright
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å Bandit
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏ —Å Codespell
   - –ê—É–¥–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å pip-audit
   - –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å pytest

2. **Security scan job**:
   - Trivy –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
   - Trivy –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è Docker –æ–±—Ä–∞–∑–æ–≤
   - –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ GitHub Security

### Prometheus –º–µ—Ç—Ä–∏–∫–∏

API Gateway –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `/metrics` endpoint –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

- `http_requests_total` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ (–º–µ—Ç–æ–¥, endpoint, —Å—Ç–∞—Ç—É—Å)
- `http_request_duration_seconds` - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ (–º–µ—Ç–æ–¥, endpoint)

–ú–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ middleware –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus.

### Docker –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–í—Å–µ Docker –æ–±—Ä–∞–∑—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å —É—á–µ—Ç–æ–º best practices:

- **Multi-stage build** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–±—Ä–∞–∑–æ–≤
- **Non-root user** - –∑–∞–ø—É—Å–∫ –æ—Ç –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`appuser`)
- **Health checks** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑** - `python:3.12-slim`

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `pyproject.toml`:

- `[tool.ruff]` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Ruff
- `[tool.pyright]` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Pyright
- `[tool.bandit]` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Bandit

### üîß –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–ò–º–ø–æ—Ä—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤**: –ò–∑-–∑–∞ –¥–µ—Ñ–∏—Å–æ–≤ –≤ –∏–º–µ–Ω–∞—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (`telegram-bot`, `api-gateway`) —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Python –∏–º–ø–æ—Ä—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä—è–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã —á–µ—Ä–µ–∑ `importlib.util` –∏–ª–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–æ–≤.

2. **Redis**: –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –±–∞–∑–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã, –Ω–æ –Ω—É–∂–µ–Ω –¥–ª—è production (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ—á–µ—Ä–µ–¥–∏).

3. **PostgreSQL**: SQLite —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ, PostgreSQL –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è production.

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

##### –ü—Ä–æ–±–ª–µ–º–∞ 1: –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞
- **–û—à–∏–±–∫–∞**: `ImportError: attempted relative import with no known parent package`
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç `scripts/start_telegram_bot.py` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤

##### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ db_path –≤ MemoryConfig
- **–û—à–∏–±–∫–∞**: `AttributeError: 'MemoryConfig' object has no attribute 'db_path'`
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω `db_path` –≤ `MemoryConfig` –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

#### ‚úÖ –í—Ö–æ–¥—è—â–∏–µ –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **–°—Ç–∞—Ç—É—Å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (voice/audio)
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤
- –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è —á–µ—Ä–µ–∑ ASR —Å–µ—Ä–≤–µ—Ä (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `ASR_SERVER_BASE_URL`)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤: .ogg, .oga, .wav, .mp3, .m4a, .flac, .webm
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: —Ç–∞–π–º–∞—É—Ç—ã, —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

#### ‚ö†Ô∏è –ò—Å—Ö–æ–¥—è—â–∏–µ –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **–°—Ç–∞—Ç—É—Å**: –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- Telethon –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É –≥–æ–ª–æ—Å–æ–≤—ã—Ö, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ TTS

---

## –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

–ü—Ä–æ–µ–∫—Ç –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:

#### –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

- `services/` - –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã (telegram-bot, api-gateway, analytics, worker)
- `shared/` - –æ–±—â–∏–µ –º–æ–¥—É–ª–∏ (database, cache, events, config, utils)
- `infrastructure/` - –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (docker-compose, kubernetes)
- `alembic/` - –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

#### –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ

- ‚úÖ Telethon —Å–µ—Å—Å–∏—è: –ø—É—Ç—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `TELEGRAM_SESSION_PATH` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `./sessions/your_bot.session`)
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite: –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ PostgreSQL)
- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (vLLM, ASR —Å–µ—Ä–≤–µ—Ä—ã)
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: `config.yaml` –æ–±–Ω–æ–≤–ª–µ–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π PostgreSQL –∏ Redis

### –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

#### 1. Telethon —Å–µ—Å—Å–∏—è

–°–µ—Å—Å–∏—è —É–∂–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –Ω–æ–≤–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é:

```bash
# –°–µ—Å—Å–∏—è –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
# –ò–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é –≤ –ø—É—Ç—å, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ TELEGRAM_SESSION_PATH
```

#### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**–í–∞—Ä–∏–∞–Ω—Ç A: –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SQLite (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)**

–ù–∏—á–µ–≥–æ –¥–µ–ª–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ - SQLite –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

**–í–∞—Ä–∏–∞–Ω—Ç B: –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ PostgreSQL**

1. –°–æ–∑–¥–∞–π—Ç–µ PostgreSQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `DATABASE_URL` –≤ `.env`:
   ```env
   DATABASE_URL=postgresql://user:password@localhost:5432/telegram_ai
   ```
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
   ```bash
   alembic upgrade head
   ```
4. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ SQLite –≤ PostgreSQL

#### 3. Redis

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Redis —á–µ—Ä–µ–∑ Docker Compose:
   ```bash
   docker-compose -f infrastructure/docker-compose.yml up -d redis
   ```
2. –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `REDIS_URL` –≤ `.env`:
   ```env
   REDIS_URL=redis://localhost:6379/0
   ```

### –ó–∞–ø—É—Å–∫ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

#### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:
   ```bash
   docker-compose -f infrastructure/docker-compose.yml up -d
   ```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Telegram Bot:
   ```bash
   uv run python scripts/start_telegram_bot.py
   ```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ API Gateway (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ):
   ```bash
   uv run python scripts/start_api_gateway.py
   ```

#### Production

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker Compose –∏–ª–∏ Kubernetes –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–°—Ç–∞—Ä—ã–π –∫–æ–¥ –≤ `src/telegram_ai/` —Å–æ—Ö—Ä–∞–Ω–µ–Ω –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É.

---

## –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Rate Limiting

### –¢–µ–∫—É—â–∏–µ –ª–∏–º–∏—Ç—ã (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–µ)

#### Per-user –ª–∏–º–∏—Ç—ã
- **15 —Å–æ–æ–±—â–µ–Ω–∏–π/–º–∏–Ω—É—Ç—É** –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **80 —Å–æ–æ–±—â–µ–Ω–∏–π/—á–∞—Å** –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ú–∏–Ω–∏–º—É–º 1 —Å–µ–∫—É–Ω–¥–∞** –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

#### –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã (–Ω–∞ –≤–µ—Å—å –∞–∫–∫–∞—É–Ω—Ç)
- **28 —Å–æ–æ–±—â–µ–Ω–∏–π/–º–∏–Ω—É—Ç—É** (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø–∞—Å –æ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã—Ö 30)
- **600 —Å–æ–æ–±—â–µ–Ω–∏–π/—á–∞—Å**

#### –õ–∏–º–∏—Ç—ã –ø–æ —Ç–∏–ø–∞–º —á–∞—Ç–æ–≤
- **–õ–∏—á–Ω—ã–µ —á–∞—Ç—ã**: 25 —Å–æ–æ–±—â–µ–Ω–∏–π/–º–∏–Ω—É—Ç—É
- **–ì—Ä—É–ø–ø—ã**: 12 —Å–æ–æ–±—â–µ–Ω–∏–π/–º–∏–Ω—É—Ç—É
- **–ö–∞–Ω–∞–ª—ã**: 5 —Å–æ–æ–±—â–µ–Ω–∏–π/–º–∏–Ω—É—Ç—É

### –õ–∏–º–∏—Ç—ã Telegram (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ)

–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Telethon –∏ –ø—Ä–∞–∫—Ç–∏–∫–µ:
- **–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –º–∞–∫—Å–∏–º—É–º**: 1 —Å–æ–æ–±—â–µ–Ω–∏–µ/—Å–µ–∫—É–Ω–¥—É = 60/–º–∏–Ω
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ª–∏–º–∏—Ç**: 20-30 —Å–æ–æ–±—â–µ–Ω–∏–π/–º–∏–Ω—É—Ç—É –Ω–∞ –≤–µ—Å—å –∞–∫–∫–∞—É–Ω—Ç
- **–ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏**: FloodWait (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ)
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞**: –ø—Ä–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö –Ω–∞ 12-24 —á–∞—Å–∞

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –£–º–µ—Ä–µ–Ω–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) ‚≠ê

```yaml
rate_limiting:
  enabled: true
  messages_per_minute: 15  # –±—ã–ª–æ 10, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ 15
  messages_per_hour: 80    # –±—ã–ª–æ 50, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ 80
  min_interval_seconds: 1  # –±—ã–ª–æ 2, —É–º–µ–Ω—å—à–∞–µ–º –¥–æ 1
  
  global:
    enabled: true
    messages_per_minute: 28  # –±—ã–ª–æ 25, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ 28 (–±–ª–∏–∂–µ –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º—É –º–∞–∫—Å–∏–º—É–º—É)
    messages_per_hour: 600   # –±—ã–ª–æ 500, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ 600
    
  chat_type_limits:
    private: 25  # –±—ã–ª–æ 20, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ 25 –¥–ª—è –±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è
    group: 12   # –±—ã–ª–æ 10, –Ω–µ–º–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º
    channel: 5  # –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–º
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã—Ö –ª–∏–º–∏—Ç–æ–≤ Telegram)
- ‚úÖ –ó–∞–º–µ—Ç–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–Ω–∏–∑–∏—Ç –ø—Ä–∏ FloodWait

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫ (–µ—Å–ª–∏ –Ω–µ –±—É–¥–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö FloodWait)

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç FloodWait)

```yaml
rate_limiting:
  enabled: true
  messages_per_minute: 20  # —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ 20
  messages_per_hour: 100   # —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ 100
  min_interval_seconds: 1  # —É–º–µ–Ω—å—à–∞–µ–º –¥–æ 1
  
  global:
    enabled: true
    messages_per_minute: 30  # –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ª–∏–º–∏—Ç
    messages_per_hour: 800  # —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ
    
  chat_type_limits:
    private: 30  # –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç –¥–ª—è –ª–∏—á–Ω—ã—Ö —á–∞—Ç–æ–≤
    group: 15    # —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–ª—è –≥—Ä—É–ø–ø
    channel: 8   # –Ω–µ–º–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç–∏—Ç –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫ (–±–ª–∏–∑–∫–æ –∫ –≥—Ä–∞–Ω–∏—Ü–µ, –Ω—É–∂–Ω–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å FloodWait)
- ‚ö†Ô∏è –ü—Ä–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö FloodWait –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–Ω–∏–∑–∏—Ç –ª–∏–º–∏—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

#### –í–∞—Ä–∏–∞–Ω—Ç 3: –£–º–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ) ‚≠ê‚≠ê‚≠ê

–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –Ω–æ –ø–æ–ª–∞–≥–∞–µ–º—Å—è –Ω–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É:

1. **–ù–∞—á–∏–Ω–∞–µ–º —Å —É–º–µ—Ä–µ–Ω–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤** (–í–∞—Ä–∏–∞–Ω—Ç 1)
2. **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—à–∏—Ä–∏—Ç –ª–∏–º–∏—Ç—ã** –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ FloodWait
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** —á–µ—Ä–µ–∑ –ª–æ–≥–∏

```yaml
rate_limiting:
  adaptive:
    enabled: true
    reduction_on_floodwait_percent: 20  # —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞ 20% –ø—Ä–∏ FloodWait
    recovery_period_minutes: 5  # –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç (–±—ã—Å—Ç—Ä–µ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)
    recovery_increment_percent: 10  # –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ 10% –∑–∞ –ø–µ—Ä–∏–æ–¥ (–±—ã—Å—Ç—Ä–µ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

#### –î–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è (–æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–í–∞—Ä–∏–∞–Ω—Ç 1** (—É–º–µ—Ä–µ–Ω–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `chat_type_limits.private: 25-30`
- –£–º–µ–Ω—å—à–∏—Ç–µ `min_interval_seconds: 1`

#### –î–ª—è –º–∞—Å—Å–æ–≤–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ (–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- –û—Å—Ç–∞–≤—å—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–º–∏ (25-28/–º–∏–Ω)
- –£–≤–µ–ª–∏—á—å—Ç–µ per-user –ª–∏–º–∏—Ç—ã —É–º–µ—Ä–µ–Ω–Ω–æ (15-20/–º–∏–Ω)
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ FloodWait —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

### –ü—Ä–æ—Ü–µ—Å—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

1. **–ù–∞—á–Ω–∏—Ç–µ —Å –í–∞—Ä–∏–∞–Ω—Ç–∞ 1** (—É–º–µ—Ä–µ–Ω–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É 1-2 –¥–Ω—è** —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É FloodWait**:
   - –ï—Å–ª–∏ FloodWait = 0 ‚Üí –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–∞–ª—å—à–µ
   - –ï—Å–ª–∏ FloodWait > 0, –Ω–æ —Ä–µ–¥–∫–∏–µ ‚Üí —Ç–µ–∫—É—â–∏–µ –ª–∏–º–∏—Ç—ã –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã
   - –ï—Å–ª–∏ FloodWait —á–∞—Å—Ç—ã–µ ‚Üí —Å–Ω–∏–∑—å—Ç–µ –ª–∏–º–∏—Ç—ã
4. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ** –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø—Ä–æ–±–ª–µ–º

### –í–∞–∂–Ω–æ ‚ö†Ô∏è

- **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ** –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç –≤—ã—à–µ 30/–º–∏–Ω (—Ä–∏—Å–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
- **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ FloodWait** - —ç—Ç–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤ Telegram
- **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç–∏—Ç** –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫, –Ω–æ –ª—É—á—à–µ –Ω–µ –¥–æ–≤–æ–¥–∏—Ç—å –¥–æ —ç—Ç–æ–≥–æ
- **–ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –∞–∫–∫–∞—É–Ω—Ç–∞** –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç 12-24 —á–∞—Å–∞

### –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –°–Ω–∏–∂–∞–µ—Ç –ª–∏–º–∏—Ç—ã –Ω–∞ 20% –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ FloodWait
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ª–∏–º–∏—Ç—ã –Ω–∞ 10% –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ FloodWait
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ FloodWait —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ FloodWait > 60 —Å–µ–∫—É–Ω–¥

---

## –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

**–î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** 2025-11-07

### ‚úÖ –£—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ

#### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ `config.yaml`
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å SQLite

#### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ SQLite –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –í—Å–µ 15 —Ç–∞–±–ª–∏—Ü —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –ó–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–∞–π–¥–µ–Ω–æ 5 –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤
- ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ PostgreSQL

#### 3. API Gateway
- ‚úÖ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- ‚úÖ 8 REST API endpoints —Ä–∞–±–æ—Ç–∞—é—Ç:
  - `GET /api/v1/leads` - —Å–ø–∏—Å–æ–∫ –ª–∏–¥–æ–≤
  - `GET /api/v1/leads/{id}` - –¥–µ—Ç–∞–ª–∏ –ª–∏–¥–∞
  - `POST /api/v1/leads` - —Å–æ–∑–¥–∞–Ω–∏–µ –ª–∏–¥–∞
  - `PUT /api/v1/leads/{id}` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∏–¥–∞
  - `GET /api/v1/conversations` - —Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤
  - `GET /api/v1/conversations/{id}` - –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞
  - `GET /api/v1/analytics/metrics` - –º–µ—Ç—Ä–∏–∫–∏
  - `GET /api/v1/analytics/reports` - –æ—Ç—á–µ—Ç—ã
- ‚úÖ Health check endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ CORS middleware –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –†–æ—É—Ç—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ —Ä–µ–∞–ª—å–Ω–æ–π –ë–î

#### 4. AI Client
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å vLLM –∏–ª–∏ OpenAI-compatible —Å–µ—Ä–≤–µ—Ä–æ–º
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `AI_SERVER_BASE_URL` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `http://localhost:8000`, –ø—Ä–æ–¥–∞–∫—à–Ω: `http://100.93.82.48:8000`)
- ‚úÖ –ú–æ–¥–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `config.yaml` –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ Timeout –Ω–∞—Å—Ç—Ä–æ–µ–Ω (30s)
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ** - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –µ—Å–ª–∏ AI —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ **Health check –∫–æ–º–∞–Ω–¥–∞** - `python -m src.telegram_ai.main health` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

#### 5. Voice Handler
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å ASR —Å–µ—Ä–≤–µ—Ä–æ–º
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `ASR_SERVER_BASE_URL` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `http://localhost:8001`, –ø—Ä–æ–¥–∞–∫—à–Ω: `http://100.93.82.48:8001`)
- ‚úÖ Timeout –Ω–∞—Å—Ç—Ä–æ–µ–Ω (180s –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –∞—É–¥–∏–æ)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤–∫–ª—é—á–µ–Ω–∞
- ‚úÖ **–£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ POST –Ω–∞ `/transcribe` (422 = —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç)

#### 6. URL Parser (–ü–∞—Ä—Å–∏–Ω–≥ –≤–µ–±-—Å—Å—ã–ª–æ–∫)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ URL –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü —á–µ—Ä–µ–∑ trafilatura (–æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥)
- ‚úÖ Fallback –Ω–∞ BeautifulSoup –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ª–∏–º–∏—Ç—ã: `max_content_length` (10000 —Å–∏–º–≤–æ–ª–æ–≤), `max_urls_per_message` (3 URL), `timeout` (10 —Å–µ–∫—É–Ω–¥)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –¥–∏–∞–ª–æ–≥–∞ - –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: —Ç–∞–π–º–∞—É—Ç—ã, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ URL, –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `config.yaml` –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è `URL_PARSING_*`
- ‚úÖ –í–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`enabled: true`)

#### 7. –°–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞
- ‚úÖ `scripts/start_telegram_bot.py` - –∑–∞–ø—É—Å–∫ Telegram Bot
- ‚úÖ `scripts/start_api_gateway.py` - –∑–∞–ø—É—Å–∫ API Gateway
- ‚úÖ `scripts/start_worker.py` - –∑–∞–ø—É—Å–∫ Worker Service
- ‚úÖ –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ

#### 7. Shared –º–æ–¥—É–ª–∏
- ‚úÖ `shared/database` - –º–æ–¥–µ–ª–∏ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ `shared/cache` - Redis –∫–ª–∏–µ–Ω—Ç
- ‚úÖ `shared/config` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ `shared/events` - —Å—Ö–µ–º—ã —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ

#### 8. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚úÖ 4 —Å–µ—Ä–≤–∏—Å–∞ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- ‚úÖ Shared –º–æ–¥—É–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º —Å–µ—Ä–≤–∏—Å–∞–º
- ‚úÖ Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞

### ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

#### 1. Redis
- ‚ö†Ô∏è Redis –Ω–µ –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- ‚úÖ –ö–ª–∏–µ–Ω—Ç Redis –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- üìù –î–ª—è production: –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ `docker-compose up redis`

#### 2. –ò–º–ø–æ—Ä—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚ö†Ô∏è –ò–∑-–∑–∞ –¥–µ—Ñ–∏—Å–æ–≤ –≤ –∏–º–µ–Ω–∞—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (`telegram-bot`, `api-gateway`) —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Python –∏–º–ø–æ—Ä—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä—è–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã —á–µ—Ä–µ–∑ `importlib.util` –∏–ª–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –≠—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–ø–æ—Å–æ–± –∏–º–ø–æ—Ä—Ç–∞

#### 3. Pytest
- ‚ö†Ô∏è Pytest –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Ç–µ–∫—É—â–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- ‚úÖ –¢–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∑–∞–ø—É—Å–∫—É
- üìù –î–ª—è –∑–∞–ø—É—Å–∫–∞: `uv add --dev pytest pytest-asyncio && uv run pytest`

#### 4. Worker Service
- ‚ö†Ô∏è Celery worker –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞, –∑–∞–¥–∞—á–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–¢–∞–±–ª–∏—Ü –≤ –ë–î**: 15
- **–ê–∫—Ç–∏–≤–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤**: 5
- **API Endpoints**: 8
- **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤**: 4
- **Shared –º–æ–¥—É–ª–µ–π**: 5
- **–°–∫—Ä–∏–ø—Ç–æ–≤ –∑–∞–ø—É—Å–∫–∞**: 3

### üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

#### ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
1. **Telegram Bot Service** - –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ `scripts/start_telegram_bot.py`
2. **API Gateway** - –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ `scripts/start_api_gateway.py`
3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å SQLite, –≥–æ—Ç–æ–≤ –∫ PostgreSQL
4. **AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** - –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Å–µ—Ä–≤–µ—Ä–∞–º
5. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

#### üìù –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
1. **Redis** - –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ rate limiting (–º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ docker-compose)
2. **PostgreSQL** - –¥–ª—è production (–º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ docker-compose)
3. **Celery Worker** - –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞)

### üéØ –í—ã–≤–æ–¥—ã

**–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- ‚úÖ API Gateway –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å AI –∏ ASR —Å–µ—Ä–≤–µ—Ä–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞ —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –∏ –Ω–µ –º–µ—à–∞—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø—Ä–æ–µ–∫—Ç–∞. Redis –∏ PostgreSQL –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

## –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏

- **–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞**: `uv run python scripts/start_telegram_bot.py`
- **–ó–∞–ø—É—Å–∫ API**: `uv run python scripts/start_api_gateway.py`
- **–¢–µ—Å—Ç—ã**: `uv run pytest tests/ -v`
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: `config.yaml`

## –í–æ–ø—Ä–æ—Å—ã?

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª [–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç–∞—Ç—É—Å-–ø—Ä–æ–µ–∫—Ç–∞) - —Å—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª [–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è](#–∏–∑–≤–µ—Å—Ç–Ω—ã–µ-–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è-–∏-–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è) - –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `logs/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
